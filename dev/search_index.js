var documenterSearchIndex = {"docs":
[{"location":"materials/#Materials","page":"Materials","title":"Materials","text":"","category":"section"},{"location":"materials/","page":"Materials","title":"Materials","text":"Material","category":"page"},{"location":"materials/#Dielectric-functions","page":"Materials","title":"Dielectric functions","text":"","category":"section"},{"location":"materials/","page":"Materials","title":"Materials","text":"epsilon_Ag","category":"page"},{"location":"materials/#CoupledDipole.epsilon_Ag","page":"Materials","title":"CoupledDipole.epsilon_Ag","text":"epsilon_Ag(λ::Real)\n\nDrude model for the dielectric function of silver in the visible region\n\nλ: wavelength in nm\n\nExamples\n\njulia> round(epsilon_Ag(632.8), digits=5)\n-16.11377 + 0.74871im\n\n\n\n\n\n","category":"function"},{"location":"materials/","page":"Materials","title":"Materials","text":"epsilon_Au","category":"page"},{"location":"materials/#CoupledDipole.epsilon_Au","page":"Materials","title":"CoupledDipole.epsilon_Au","text":"epsilon_Au(λ::Real)\n\nExtended Drude model for the dielectric function of gold in the visible region\n\nλ: wavelength in nm\n\nExamples\n\njulia>  round(epsilon_Au(632.8), digits=5)\n-11.40185 + 1.18679im\n\n\n\n\n\n","category":"function"},{"location":"materials/#Particle-polarisabilities","page":"Materials","title":"Particle polarisabilities","text":"","category":"section"},{"location":"materials/","page":"Materials","title":"Materials","text":"alpha_kuwata","category":"page"},{"location":"materials/#CoupledDipole.alpha_kuwata","page":"Materials","title":"CoupledDipole.alpha_kuwata","text":"alpha_kuwata(λ, ε, ε_m, Size)\n\nPrincipal polarisability components of a spheroidal particle\n\nλ: wavelength\nε: complex dielectric function\nε_m: dielectric function of surrounding medium\nSize: SVector with 3 semi-axes of the spheroid\n\nExamples\n\njulia> alpha_kuwata(500, -10+1im, SVector(30, 30, 50), 1.33^2)\n3-element SVector{3, ComplexF64} with indices SOneTo(3):\n  77076.04648078184 + 26235.664281642235im\n  77076.04648078184 + 26235.664281642235im\n -98187.15974124733 + 205835.30299929058im\n\n\n\n\n\n","category":"function"},{"location":"materials/","page":"Materials","title":"Materials","text":"alpha_spheroids","category":"page"},{"location":"materials/#CoupledDipole.alpha_spheroids","page":"Materials","title":"CoupledDipole.alpha_spheroids","text":"alpha_spheroids(λ, ε, ε_m, Sizes)\n\nPrincipal polarisability components of N spheroidal particles\n\nλ: wavelength\nε: complex dielectric function\nε_m: dielectric function of surrounding medium\nSizes: Vector of 3-SVectors of particle sizes\n\nExamples\n\njulia> alpha_spheroids(500, -10+1im, 1.33^3, [SVector(30, 30, 50) for i in 1:4])\n4-element Vector{SVector{3, ComplexF64}}:\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n\n\n\n\n\n","category":"function"},{"location":"materials/#Molecular-polarisabilities","page":"Materials","title":"Molecular polarisabilities","text":"","category":"section"},{"location":"materials/","page":"Materials","title":"Materials","text":"lorentzian","category":"page"},{"location":"materials/#CoupledDipole.lorentzian","page":"Materials","title":"CoupledDipole.lorentzian","text":"lorentzian(λ::T, α_k::T, λ_k::T, µ_k::T) where T <: Real\n\nComplex Lorentz function, to describe polarisabilities\n\nλ: wavelength in nm\nα_k: oscillator strength in S.I. units\nλ_k: oscillator wavelength in nm\nµ_k: damping in S.I. units\n\nExamples\n\njulia> round(lorentzian(632.8)*1e39, digits=5)\n6.58095 + 1.35961im\n\n\n\n\n\n","category":"function"},{"location":"materials/","page":"Materials","title":"Materials","text":"lorentzian","category":"page"},{"location":"materials/","page":"Materials","title":"Materials","text":"alpha_bare","category":"page"},{"location":"materials/#CoupledDipole.alpha_bare","page":"Materials","title":"CoupledDipole.alpha_bare","text":"alpha_bare(λ::T, α_∞::T, α_k::Array{T}, λ_k::Array{T}, µ_k::Array{T}) where T <: Real\n\nComplex scalar polarisability, as sum of lorentz oscillators\n\nλ: wavelength in nm\nα_k: oscillator strength(s) in S.I. units\nλ_k: oscillator wavelength(s) in nm\nµ_k: damping(s) in S.I. units\n\nDefault values mimic the main resonance of Rhodamine 700\n\nExamples\n\njulia> round(alpha_bare(632.8), digits=5)\n0.14543 + 0.01222im\n\n\n\n\n\n","category":"function"},{"location":"materials/","page":"Materials","title":"Materials","text":"alpha_embedded","category":"page"},{"location":"materials/#CoupledDipole.alpha_embedded","page":"Materials","title":"CoupledDipole.alpha_embedded","text":"alpha_embedded(α::Complex{T}, medium::T) where T <: Real\n\nEffective point polarisability in medium, rescaled by local field correction\n\nα: bare polarisabilty\nmedium: refractive index of embedding medium\n\nDefault values mimic the main resonance of Rhodamine 700\n\nExamples\n\njulia> round(alpha_embedded(alpha_bare(632.8)), digits=5)\n0.12976 + 0.0109im\n\n\n\n\n\n","category":"function"},{"location":"materials/","page":"Materials","title":"Materials","text":"alpha_rescale_molecule","category":"page"},{"location":"materials/#CoupledDipole.alpha_rescale_molecule","page":"Materials","title":"CoupledDipole.alpha_rescale_molecule","text":"alpha_rescale_molecule(alpha, sizes::Vector{SVector{3}})\n\nPrincipal polarisability components of a particle, rescaled along each principal axis\n\nα: scalar polarisabilty\nsizes: array of 3-vectors to scale along each principal axis\n\n\n\n\n\n","category":"function"},{"location":"system/#System-of-equations","page":"System of equations","title":"System of equations","text":"","category":"section"},{"location":"system/","page":"System of equations","title":"System of equations","text":"propagator_freespace_labframe!","category":"page"},{"location":"system/#CoupledDipole.propagator_freespace_labframe!","page":"System of equations","title":"CoupledDipole.propagator_freespace_labframe!","text":"propagator_freespace_labframe!(A,\n    kn, R::Vector{SVector{3}},\n    AlphaBlocks::Vector{SMatrix{3,3}})\n\nInteraction matrix\n\nA: 3N_dip x 3N_dip interaction matrix\nkn: wavenumber in incident medium\nR: N_dip-vector of 3-Svectors of particle positions\nAlphaBlocks: N_dip-vector of 3x3 Smatrices (polarisability tensors in the lab frame)\n\n\n\n\n\n","category":"function"},{"location":"system/","page":"System of equations","title":"System of equations","text":"incident_field!","category":"page"},{"location":"system/#CoupledDipole.incident_field!","page":"System of equations","title":"CoupledDipole.incident_field!","text":"incident_field!(Ein,\n    Ejones,\n    kn, R::Vector{SVector{3}},\n    IncidenceRotations)\n\nIncident field at particle positions\n\nEin: 3N_dip x N_inc matrix, right-hand side of coupled-dipole system\nEjones: tuple of 2 2-Svectors defining 2 orthogonal Jones polarisations\nkn: wavenumber in incident medium\nR: N_dip-vector of 3-Svectors of particle positions\nIncidenceRotations: N_inc-vector of rotation 3-Smatrices\n\n\n\n\n\n","category":"function"},{"location":"system/","page":"System of equations","title":"System of equations","text":"polarisation!","category":"page"},{"location":"system/#CoupledDipole.polarisation!","page":"System of equations","title":"CoupledDipole.polarisation!","text":"polarisation!(P, E, AlphaBlocks)\n\nSelf-consistent dipole moments from the electric field, P = αE\n\nP: 3N_dip x N_inc matrix, polarisations for all incidences\nE: 3N_dip x N_inc matrix, total field for all incidences\nAlphaBlocks: N_dip-vector of 3x3 Smatrices (polarisability tensors in the lab frame)\n\n\n\n\n\n","category":"function"},{"location":"utils/#Utility-functions","page":"Utility functions","title":"Utility functions","text":"","category":"section"},{"location":"utils/#Euler-rotations","page":"Utility functions","title":"Euler rotations","text":"","category":"section"},{"location":"utils/","page":"Utility functions","title":"Utility functions","text":"euler_active","category":"page"},{"location":"utils/#CoupledDipole.euler_active","page":"Utility functions","title":"CoupledDipole.euler_active","text":"euler_active(φ::Real, θ::Real, ψ::Real)\n\n3D rotation matrix\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\nψ: Euler angle (rotation around z\", in [0,2π])\n\nExamples\n\njulia> round.(euler_active(π/2,0,0), digits=5)\n3×3 SMatrix{3, 3, Float64, 9} with indices SOneTo(3)×SOneTo(3):\n  0.0  -1.0  0.0\n  1.0   0.0  0.0\n -0.0   0.0  1.0\n\n\n\n\n\n","category":"function"},{"location":"utils/","page":"Utility functions","title":"Utility functions","text":"euler_passive","category":"page"},{"location":"utils/#CoupledDipole.euler_passive","page":"Utility functions","title":"CoupledDipole.euler_passive","text":"euler_passive(φ::Real, θ::Real, ψ::Real)\n\n3D rotation matrix\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\nψ: Euler angle (rotation around z\", in [0,2π])\n\nExamples\n\njulia> round.(euler_passive(π/2,0,0), digits=5)\n3×3 SMatrix{3, 3, Float64, 9} with indices SOneTo(3)×SOneTo(3):\n  0.0  1.0  -0.0\n -1.0  0.0   0.0\n  0.0  0.0   1.0\n\n\n\n\n\n","category":"function"},{"location":"utils/","page":"Utility functions","title":"Utility functions","text":"euler_unitvector","category":"page"},{"location":"utils/#CoupledDipole.euler_unitvector","page":"Utility functions","title":"CoupledDipole.euler_unitvector","text":"euler_unitvector(φ::Real, θ::Real)\n\nUnit vector along direction φ, θ\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\n\nExamples\n\njulia> euler_unitvector(π/2, 0)\n3-element SVector{3, Float64} with indices SOneTo(3):\n 0.0\n 0.0\n 1.0\n\n\n\n\n\n","category":"function"},{"location":"utils/#Spherical-cubature","page":"Utility functions","title":"Spherical cubature","text":"","category":"section"},{"location":"utils/","page":"Utility functions","title":"Utility functions","text":"quadrature_lgwt","category":"page"},{"location":"utils/#CoupledDipole.quadrature_lgwt","page":"Utility functions","title":"CoupledDipole.quadrature_lgwt","text":"quadrature_lgwt(N::Int, a::Real, b::Real)\n\nN-point Gauss-Legendre quadrature over [a,b] interval\n\nN: number of nodes\na,b: bounds\n\nint_a^b f(x)dx=fracb-a2int_-1^1fleft(fracb-a2 x + fraca+b2right)dx\n\nExamples\n\njulia> quadrature_lgwt(6,0,3)\n(nodes = [0.10129572869527204, 0.5081859203006033, 1.1420712208752046, 1.8579287791247954, 2.4918140796993966, 2.898704271304728], weights = [0.25698673856875537, 0.5411423595722078, 0.7018709018590369, 0.7018709018590369, 0.5411423595722078, 0.25698673856875537])\n\n\n\n\n\n","category":"function"},{"location":"utils/","page":"Utility functions","title":"Utility functions","text":"cubature_sphere","category":"page"},{"location":"utils/#CoupledDipole.cubature_sphere","page":"Utility functions","title":"CoupledDipole.cubature_sphere","text":"cubature_sphere(N::Int, method::String)\n\nN-point cubature on the sphere\n\nN: number of nodes\nmethod: cubature method (only 'gl' currently implemented)\n\nReturns a Cubature object containing 2 arrays (N'x3 nodes and N'x1 weights), N'≈N Note: using array instead of tuple for weights because we'll use them in a scalar product in orientation-averaging For nodes there is less of a reason, but it can be convenient to visualise the nodes.\n\nThe cubature is normalised by 4π such that a unit integrand approximates 1.\n\nExamples\n\njulia> cubature_sphere(6)\n(nodes = SVector{3, Float64}[[0.43625314334650644, 2.1862760354652844, 0.0], [0.43625314334650644, 0.9553166181245093, 0.0], [2.0735107047038173, 2.1862760354652844, 0.0], [2.0735107047038173, 0.9553166181245093, 0.0], [4.2096746024757685, 2.1862760354652844, 0.0], [4.2096746024757685, 0.9553166181245093, 0.0], [5.846932163833079, 2.1862760354652844, 0.0], [5.846932163833079, 0.9553166181245093, 0.0]], weights = [0.08696371128436346, 0.08696371128436346, 0.16303628871563655, 0.16303628871563655, 0.16303628871563655, 0.16303628871563655, 0.08696371128436346, 0.08696371128436346])\n\n\n\n\n\n","category":"function"},{"location":"gettingstarted/#Getting-Started","page":"Getting Started","title":"Getting Started","text":"","category":"section"},{"location":"gettingstarted/#Installation","page":"Getting Started","title":"Installation","text":"","category":"section"},{"location":"gettingstarted/","page":"Getting Started","title":"Getting Started","text":"Pkg.add(\"CoupledDipole\")","category":"page"},{"location":"conventions/#Conventions","page":"Conventions","title":"Conventions","text":"","category":"section"},{"location":"conventions/","page":"Conventions","title":"Conventions","text":"    <div id=\"webgl\"></div>\n    <script>\n      (function () {\n     \n     \tvar webglEl = document.getElementById('webgl');\n     \n     \tif (!Detector.webgl) {\n     \t\tDetector.addGetWebGLMessage(webglEl);\n     \t\treturn;\n     \t}\n     \n     \tvar width  = 400,\n     \t\theight = 400;\n     \n     \t// sphere params\n     \tvar radius   = 1,\n     \t\tsegments = 36,\n     \t\trotation = 6;  \n     \n     \tvar scene = new THREE.Scene();\n     \n     \tvar camera = new THREE.PerspectiveCamera(20, width / height, 0.01, 1000);\n     \t\n     \tcamera.position.z = 10;\n     \n     \tvar renderer = new THREE.WebGLRenderer();\n     \trenderer.setSize(width, height);\n     \n     \tscene.add(new THREE.AmbientLight(0xffffff, 1));\n     \n     \tvar xDistance = 2;\n       var yDistance = 2;\n         //initial offset so does not start in middle.\n         var xOffset = 0;\n         var yOffset = 1;\n         \n        var i=0,j=0;\n        var sphere1 = createSphere(radius, segments);\n        sphere1.position.y = - yOffset;\n        sphere1.position.x = - xOffset;\n        sphere1.scale.set( 0.5, 0.5, 0.8 );\n        scene.add(sphere1);\n        \n        var sphere2 = createSphere(radius, segments);\n        sphere2.position.y = yOffset;\n        sphere2.position.x = xOffset;\n        sphere2.scale.set( 0.5, 0.5, 0.8 );\n        \n       // sphere2.rotation.x = 1.57;\n        sphere2.rotation.y = 0.7853982;\n        scene.add(sphere2);\n             \t\t\n     \n     \tvar controls = new THREE.TrackballControls(camera);\n     \n     \twebglEl.appendChild(renderer.domElement);\n     \n     \trender();\n     \n     \tfunction render() {\n     \t\tcontrols.update();\n     \t\trequestAnimationFrame(render);\n     \t\trenderer.render(scene, camera);\n     \t}\n     \n     \tfunction createSphere(radius, segments) {\n     \t\treturn new THREE.Mesh(\n     \t\t\tnew THREE.SphereGeometry(radius, segments, segments),\n     \t\t);\n     \t}\n     \n     \n     }());\n    </script>","category":"page"},{"location":"theory/#Coupled-dipole-theory","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"From a microscopic viewpoint, as taken in the discrete dipole approximation, a collection of small inclusions such as molecules dispersed in a solvent may be described as a set of point dipoles in a vacuum, whereby not only the molecules of interest but also those comprising the medium itself are described as discrete dipoles. This approach is numerically prohibitive, due to the large number of dipoles required to model the environment, which is in fact infinite in most situations of interest. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"With a more pragmatic approach, we are led to consider the response of dipoles within the framework of the macroscopic Maxwell equations, where the optical response of the solvent is encompassed in its refractive index n=sqrtvarepsilon. Waves propagating in this medium have a phase velocity cn. Light scattering by a collection of particles (or molecules) will thus be described as the interaction between dipole moments induced by the incident light and in mutual interaction via their own scattered field in the surrounding homogeneous medium, as illustrated in Fig..","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"We define the dipole moments mathbfP to be proportional to the local (macroscopic) electric field,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfP = mathbbalpha mathbfE","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"where mathbbalpha is a 3times 3 polarisability tensor, which will be discussed in section. The standard CD equations take the form,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfP^i= mathbbalpha_i left( mathbfE_textinc + sum_jneq i mathbbG_ij mathbfP^jright)","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"yielding a linear system of 3N equations to be solved for the unknown polarisation vector mathbfP.","category":"page"},{"location":"theory/#Green's-tensor-in-a-medium","page":"Coupled dipole theory","title":"Green's tensor in a medium","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"We derive in the Appendix the macroscopic field associated with a dipole in a medium,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfE(mathbfr) =kappa^-1 fracmathrmexp(ikr)rleftk_1^2leftmathbfP - (mathbfhat rcdotmathbfP)mathbfhat r right + left(frac1r^2 - fracik_1rright) left3mathbfhat r(mathbfhat rcdotmathbfP) - mathbfPright rightqquad kappa = 4pivarepsilon_0varepsilon","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"which we may write as","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfE = mathbbG mathbfP","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"with, ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbbG = kappa^-1 fracmathrmexp(ikr)rleftk_1^2leftmathbbI - mathbfhat rotimesmathbfhat r right - left(frac1r^2 - fracik_1rright) leftmathbbI - 3mathbfhat rotimesmathbfhat rright right","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Note the constant prefactor kappa which will also appear in the definition of the polarisability, allowing us to diregard it throughout the code implementation, as discussed in section.","category":"page"},{"location":"theory/#Coupled-dipole-equations","page":"Coupled dipole theory","title":"Coupled dipole equations","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Since our code aims to model not only particles but also molecules, which can have a non-invertible tensor (for example a uniaxial response), this formulation is not suitable\\footnote{note that for uniaxial or isotropic dipoles, a simplified version of the CDA could be derived cf Govorov, Berova, but we are aiming for a fully general coupled dipole method}: solving for the polarisation mathbfP, one needs to form a matrix with block diagonal elements mathbbalpha^-1, where two of the principal components would become infinite. Instead, we recast the coupled dipole equations in a different form, solving for the self-consistent macroscopic fields at the dipole positions. This field mathbfE^i is the sum of the incident field and the field scattered by all other dipoles,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfE^i=mathbfE_textinc(mathbfr_i) + sum_jneq i mathbbG_ij mathbbalpha_j mathbfE^j","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"where mathbbG_ij = mathbbG(mathbfr_imathbfr_j) is the Green's tensor for the field created by dipole i at the location of dipole j in the infinite surrounding medium, ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbbG_ij = kappa^-1fracmathrmexp(ikr)_ijr_ijleftk_1^2leftmathbbI - mathbfhat r_ijotimesmathbfhat r_ij right - left(frac1r_ij^2 - fracik_1r_ijright) leftmathbbI - 3mathbfhat r_ijotimesmathbfhat r_ijright right","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Note that optical reciprocity imposes the symmetry mathbbG_ji = mathbbG^intercal_ij. Grouping the fields mathbfE^i and mathbfE_textinc(mathbfr_i) into vectors mathbfE and mathbfE_textinc of length 3N, where N is the number of dipoles, the coupled system takes the matrix form, ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbbF mathbfE  = mathbfE_textinc","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"defining the free-space interaction matrix mathbb F  = (mathbb I - mathbb Gmathbbalpha ).  The 3times 3 diagonal blocks of mathbbF are identity matrices, and each off-diagonal block is of the form mathbb F_ij = -mathbb G_ijmathbbalpha_j. Note that the product mathbb Gmathbbalpha implies that mathbb F is not longer (block-)symmetric, for an arbitrary set of polarisabilies (either unlike particles, or simply rotated along arbitrary orientations). For a three-dipoles system, the matrix representation can be written,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"left\nbeginpmatrix\nmathbbImathbbOmathbbO\nmathbbOmathbbImathbbO\nmathbbOmathbbOmathbbI\nendpmatrix -\nbeginpmatrix\nmathbbOmathbbG_12mathbbalpha_2mathbbG_13mathbbalpha_3\nmathbbG_21mathbbalpha_1mathbbOmathbbG_23mathbbalpha_3\nmathbbG_31mathbbalpha_1mathbbG_32mathbbalpha_2mathbbO\nendpmatrix\nright\nbeginpmatrix\nmathbfE^1\nmathbfE^2\nmathbfE^3\nendpmatrix = \nbeginpmatrix\nmathbfE_textinc^1\nmathbfE_textinc^2\nmathbfE_textinc^3\nendpmatrix ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The linear system is solved by standard linear algebra routines (LU factorisation), yielding the self-consistent macroscopic electric field mathbfE at each dipole location. From these local fields we can calculate the polarisation mathbfP = mathbbalpha mathbfE.","category":"page"},{"location":"theory/#Order-of-scattering-solution","page":"Coupled dipole theory","title":"Order-of-scattering solution","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"An alternative approach to solving the system of coupled dipole equations is to follow an order-of-scattering approximation scheme. The linear system of equations is formally re-written as","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"beginaligned\nmathbbF mathbfE = mathbfE_textinc\n mathbfE = (mathbbI - mathbbalphamathbbG)^-1 mathbfE_textinc\n mathbfE = (mathbbI + mathbbalphamathbbG + (mathbbalphamathbbG)^2 + (mathbbalphamathbbG)^3 +dots) mathbfE_textinc\n mathbfE = underbracemathbfE_textinc_mathbfE^0 + underbracemathbbalphamathbbGmathbfE^0_mathbfE^1 + underbracemathbbalphamathbbGmathbfE^1_mathbfE^2 + underbracemathbbalphamathbbGmathbfE^2_mathbfE^3 +dots\nendaligned","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The system (mathbbI - mathbbalphamathbbG) mathbfE = mathbfE_textinc is thus solved iteratively by defining a temporary variable mathbfE^n and taking the following steps,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"beginaligned\nmathbfE^0 = mathbfE_textinc  mathbfE = mathbfE^0\nmathbfE^1 = mathbbalphamathbbGmathbfE^0   mathbfE = mathbfE^0 + mathbfE^1\nmathbfE^2 = mathbbalphamathbbGmathbfE^1          mathbfE = mathbfE^0 + mathbfE^1 + mathbfE^2\ndots \nendaligned","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"At each step we update the net field by adding a component corresponding to an higher order of multiple scattering. The procedure is followed iteratively until convergence of mathbfE is achieved with sufficient accuracy. Typically, the convergence criterion may be chosen as the relative change in the value of a far-field cross-section from one iteration to the next. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"If the interaction between dipoles mathbbalphamathbbG is no stronger than the contribution due to the incident field alone (mathbbI), convergence may be obtained and after a few iterations the polarisation and electric fields have reached their self-consistent value.","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"This procedure was implemented, and can be useful for relatively large systems of dipoles provided they do not interact too strongly. ","category":"page"},{"location":"theory/#Cross-sections","page":"Coupled dipole theory","title":"Cross-sections","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Physically-relevant quantities accessible to experiments that may be derived from the solution of the CD equations include the far-field cross-sections for scattering, absorption, and extinction.","category":"page"},{"location":"theory/#Scattering","page":"Coupled dipole theory","title":"Scattering","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The scattering cross-section can be computed by integrating the flux of the Poynting vector over all scattering directions in the far-field. For a single dipole, the result is,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"sigma_textsca = frack_1^4 6pivarepsilon alpha^2","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"And for a collection of dipoles,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"sigma_textsca = kappa^-2 k_1^4 iint_Omega leftsum_i left(mathbbI - mathbfhat notimesmathbfhat nright) mathbfP_i mathrmexp(-ik_1 mathbfr_icdotmathbfhat n)right^2 textdOmega","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"As an alternative, the scattering cross-section may be obtained from the difference between extinction and absorption cross-sections\\footnote{Markel derived this alternative expression by direct integration of the scattering cross-section over all scattering directions.}.","category":"page"},{"location":"theory/#Extinction","page":"Coupled dipole theory","title":"Extinction","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The extinction cross-section may be obtained from the optical theorem as the interference between incident and scattered fields\\cite{mishchenko1},","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"sigma_textext = 4pikappa^-1 k_1 Imleft(mathbfP cdot mathbfE_textinc^* right)","category":"page"},{"location":"theory/#Absorption","page":"Coupled dipole theory","title":"Absorption","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The absorption cross-section is obtained by evaluating the work done by the total field, (but excluding self-reaction), on the dipoles:","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"sigma_textabs =  4pi kappa^-1 k_1 leftImleft(mathbfP cdot mathbfE^* right) - frac 2 3 kappa^-1 k_1^3 mathbfP^2right","category":"page"},{"location":"theory/#Polarisability-prescriptions","page":"Coupled dipole theory","title":"Polarisability prescriptions","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"We defined the polarisability by the following relation between dipole moment and electric field,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbfP=mathbbalphamathbfE","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"noting that different authors include various prefactors such as 4pi, varepsilon, varepsilon_0 or combinations thereof. Polarisability prescriptions that are compatible with our chosen conventions are reviewed in this section. First, we consider the case of a subwavelength nanoparticle, with the standard static polarisability of a small sphere (\"Clausius-Mossotti\" polarisability), and a long-wavelength approximation for elongated particles that includes corrections for radiative damping and dynamic depolarisation.","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"We also discuss the polarisability of dye molecules, and its link to a microscopic (intrinsic) polarisability that may be obtained from first principle calculations.","category":"page"},{"location":"theory/#Effective-scaling-prefactor","page":"Coupled dipole theory","title":"Effective scaling prefactor","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The prefactor kappa appears in several equations and simplifies in the final expression for the cross-sections. We can therefore simplify the formalism throughout by defining reduced variables baralpha bar mathbfP barmathbbG. The correspondence is summarised in Table. Only the scaled quantities are used in the code, but for simplicity we refer to them with conventional variable names.","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Equivalence between theory and rescaled equations used in the code. The prefactor kappa=4pivarepsilon_0varepsilon can be simplified throughout by defining a suitably scaled polarisability.","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":" Theory (with kappa = 4pivarepsilon_0varepsilon) Equivalent formulation used in the code\npolarisability alpha baralpha = kappa^-1alpha\nsphere (CM) alpha_textcm = kappa a^3fracvarepsilon - varepsilonvarepsilon +2 varepsilon baralpha_textcm = a^3fracvarepsilon - varepsilonvarepsilon +2 varepsilon\ndipole moment mathbfP = alphamathbfE barmathbfP = kappa^-1mathbfP\nGreen's function mathbbG= kappa^-1 fracmathrmexp(ikr)rleftdotsright barmathbbG = kappamathbbG = fracmathrmexp(ikr)rleftdotsright\nsigma_textext 4pi kappa^-1 k_1   Imleft(mathbfP cdot mathbfE_textinc^* right) 4pi k_1  Imleft(barmathbfP cdot mathbfE_textinc^* right)\nsigma_textabs 4pi kappa^-1 k_1 left Imleft(mathbfP cdot mathbfE^* right) - frac23kappa^-1k^3mathbfP^2 right 4pi k_1 left Imleft(barmathbfP cdot mathbfE^* right) - frac23k^3barmathbfP^2 right\nsigma_textsca kappa^-2k_1^4 iint_Omega leftsum_i left(mathbbI - mathbfhat notimesmathbfhat nright) mathbfP_i e^-ik_1 mathbfr_icdotmathbfhat nright^2 textdOmega k_1^4 iint_Omega leftsum_i left(mathbbI - mathbfhat notimesmathbfhat nright) barmathbfP_i e^-ik_1 mathbfr_icdotmathbfhat nright^2 textdOmega","category":"page"},{"location":"theory/#Particle-polarisability","page":"Coupled dipole theory","title":"Particle polarisability","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The static polarisability of a sphere of radius a in a medium is given by (ref. Jackson, Griffith) (note that the dielectric constant varepsilon is sometimes factored in the dipole moment instead),","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"mathbbalpha = kappa a^3 fracvarepsilon - varepsilon_pvarepsilon + 2 varepsilon_pmathbbI qquad mathbfP=mathbbalphamathbfE","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"This equation describes the response of a spherical particle to a static electric field. In nano-optics, the nanoparticles may be much smaller than the wavelength (and therefore are excited by an essentially constant field at any given time), but the time-variation of the fields implies that the induced dipole radiates. This requires a correction to the polarisability to satisfy energy conservation, namely an imaginary component accounting for radiative reaction. This subject will be further discussed in section. Meier and Wokaun proposed\\cite{} that larger nanoparticles may also benefit from a dynamic-depolarisation correction, which takes into account the dephasing of the internal field across finite nanoparticles and provides a more accurate description of their optical response. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"For homogeneous nanospheres and spherical nanoshells, the Mie theory readily provides an exact polarisability, but in practice it is often sufficient to use an approximate (but closed-form) formula. For other geometries, no analytical solution is known. The static polarisability of ellipsoids may be derived analytically, and long-wavelength corrections have been proposed following the strategy of Meier and Wokaun. The accuracy is however rather poor in practice\\cite{moroz,luke}, and we use instead the semi-empirical formula proposed by Kuwata et al. based on fits of full-wave simulations\\cite{kuwata}. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"alpha_i =  fracV4pifrac1L_i + fracvarepsilonvarepsilon_p-varepsilon + \n              A varepsilon x^2 +  B varepsilon^2 x^4 - ifrac4pi^2varepsilon^323  V lambda^3","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"with V the volume of the particle, and x = frac2pi a_ilambda the size parameter along the semi-axis a_i (a, b, or c in the case of spheroids).","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"A numerical test of the validity of these polarisability prescriptions against exact results is presented in Appendix.","category":"page"},{"location":"theory/#Dye-polarisability","page":"Coupled dipole theory","title":"Dye polarisability","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"In our derivation of the CD equations we have taken a fully macroscopic viewpoint. In the case of molecular dipoles, the embedded dipoles (external inclusions), however, are still microscopic entities responding to the microscopic (local) field\\footnote{Note that this strategy relies on relatively low concentrations of inclusions, with the solvent concentration being so large in comparison that it largely dictates the optical response (refractive index) of the medium (?). In the DDA such a requirement is not applicable, since dense particles are modelled with discrete dipoles. The strategy used to consider an embedding medium is different: one considers an equivalent problem in vaccuum, rescaling the permittivity of each consituent material and the incident wavevector. Perhaps this strategy could also be used for molecular dipoles, but it is not clear how to scale the polarisability. One idea might be to consider the three orthogonal dipoles as describing a static ellipsoid, for which depolarisation factors are known, reverse-engineer the link between alpha and epsilon for this effective particle, and apply the equivalence strategy to this effective epsilon before performing the inverse transformation to an alpha. Does that make sense? Are we losing generality by considering an ellipsoid? (I wouldn't think so – it's the only shape that has homogeneous internal field, and we want an homogeneous field to define a macroscopic polarisability over that effective volume).}.","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"At a microscopic level, a dipole reacts to the applied field with an intrinsic polarisability alpha^mu. The applied field is enhanced by a local-field correction arising from the polarisation of the embedding medium, thus we may define an effective polarisability for the dipole responding to a macroscopic field,","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":" p = L alpha^mu mathbfE","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"where L = dfracvarepsilon +23. In turn, such a dipole moment produces a field which is enhanced by the same local field factor, from a reciprocity argument. For our purposes, the effective macroscopic polarisability is therefore defined as","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"alpha = L^2 alpha^mu","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"where alpha^mu may have been obtained from first-principle calculations (e.g. DFT). With this link, the dipole moments all respond to macroscopic fields, and the coupling between dipoles follows the same equations as above, with macroscopic fields propagating in the ambient medium. We note that if the molecular response is derived from an experimental UV-vis absorption measurement, these considerations are not important: we can directly link the extinction (or absorption) cross-section to a macroscopic polarisability. This strategy is further discussed in the Appendix.","category":"page"},{"location":"theory/#Rotations-and-orientation-averaging","page":"Coupled dipole theory","title":"Rotations and orientation averaging","text":"","category":"section"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"The simulations are set up with respect to a fixed frame of reference (\"lab frame\"\"). The particle positions and orientations, as well as the incident field, are all specified in this common frame. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Rotation matrices are defined via Euler angles. Such matrices are used to specify particle orientations by rotation of their polarisability tensor. ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"Similarly, the incident wavevector and electric field are rotated to an arbitrary direction of incidence.  ","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"For the simulation of optical activity, or of disordered systems, we are often required to perform an average over the directions of incident light (incidence and polarisation). A given incident field is characterised by a wave-vector mathbfk and an electric vector mathbfE_textinc describing the light polarisation, and both of these vectors can be rotated using a rotation matrix R. The spectra are averaged over two orthogonal polarisations, with incident wave-vectors that span the full range of varphiin02pi thetain0pi. This averaging is performed by numerical integration\\footnote{note: a few papers propose analytical angular-averaged cross-sections, e.g. Khlebstov, but there doesn't appear to be any gain in efficiency as the formulas are relatively cumbersome and costly to evaluate numerically.}","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"leftsigmaright_Omega=frac1 4pi int_0^2piint_0^pi sigma(varphipsi) sin theta dtheta dvarphi","category":"page"},{"location":"theory/","page":"Coupled dipole theory","title":"Coupled dipole theory","text":"using a quadrature scheme (Gauss-Legendre, Monte-Carlo, etc.). A lighter alternative is often used in such calculations, averaging only three particular directions of the incident field. Note that by choosing theta points such that costheta is uniformly distributed in -11, the associated change of variable automatically embeds the sintheta factor.","category":"page"},{"location":"clusters/#Cluster-geometries","page":"Cluster geometries","title":"Cluster geometries","text":"","category":"section"},{"location":"clusters/","page":"Cluster geometries","title":"Cluster geometries","text":"Cluster","category":"page"},{"location":"clusters/","page":"Cluster geometries","title":"Cluster geometries","text":"cluster_single","category":"page"},{"location":"clusters/#CoupledDipole.cluster_single","page":"Cluster geometries","title":"CoupledDipole.cluster_single","text":"cluster_single(a::T, b::T, c::T, α::T = 0.0, β::T = 0.0, γ::T = 0.0) where T <: Real\n\nParticle cluster consisting of a single particle at the origin\n\na,b,c: semi-axis along x,y,z\nα,β,γ: Euler angles\nmaterial: String referencing the material of the particle\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\njulia> cluster_single(1.0,2.0,3.0)\nCluster{Float64, Float64, Float64}(SVector{3, Float64}[[0.0, 0.0, 0.0]], SVector{3, Float64}[[0.0, 0.0, 0.0]], SVector{3, Float64}[[1.0, 2.0, 3.0]], \"Au\", \"particle\")\n\n\n\n\n\n","category":"function"},{"location":"clusters/","page":"Cluster geometries","title":"Cluster geometries","text":"cluster_dimer","category":"page"},{"location":"clusters/#CoupledDipole.cluster_dimer","page":"Cluster geometries","title":"CoupledDipole.cluster_dimer","text":"cluster_dimer(d::T, a::T, b::T, c::T, dihedral::T = 0.0, α_1::T = 0.0, α_2::T = 0.0) where T <: Real\n\nParticle cluster consisting of 2 identical particles separated along y\n\na,b,c: semi-axes along x,y,z\ndihedral: angle between both particles seen along the y-axis\nmaterial: String referencing the material\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\njulia> cluster_dimer(10, 1, 2, 3)\nCluster{Float64, Float64, Int64}(SVector{3, Float64}[[0.0, -5.0, 0.0], [0.0, 5.0, 0.0]], SVector{3, Float64}[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], SVector{3, Int64}[[1, 2, 3], [1, 2, 3]], \"Au\", \"particle\")\n\n\n\n\n\n","category":"function"},{"location":"clusters/","page":"Cluster geometries","title":"Cluster geometries","text":"cluster_helix","category":"page"},{"location":"clusters/#CoupledDipole.cluster_helix","page":"Cluster geometries","title":"CoupledDipole.cluster_helix","text":"cluster_helix(N, a, b, c, R, λ, δ = π/4, δ_0 = 0, handedness=\"left\",\n    material = \"Au\", type=\"particle\")\n\nHelical cluster of N identical particles with axis along z\n\nN: number of particles\na,b,c: semi-axes along x,y,z\nR: helix radius\nλ: helix pitch\nδ: angle between subsequent particles\nδ: starting angle\nhandedness: \"left\" or \"right\"\nmaterial: String referencing the material\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\ncluster_helix(5, 20, 20, 30, 50, 300)\n\n\n\n\n\n","category":"function"},{"location":"high_level/#High-level-Interface","page":"High-level Interface","title":"High-level Interface","text":"","category":"section"},{"location":"high_level/","page":"High-level Interface","title":"High-level Interface","text":"spectrum_dispersion","category":"page"},{"location":"high_level/#CoupledDipole.spectrum_dispersion","page":"High-level Interface","title":"CoupledDipole.spectrum_dispersion","text":" spectrum_dispersion(cl::Cluster, mat::Material,\n                     Incidence, N_sca::Int=36)\n\nSimulating far-field cross-sections for multiple wavelengths and directions of incidence\n\ncl: cluster of particles\nmat: dielectric functions\nIncidence: N_inc vector of 3-Svectors of incidence Euler angles\nN_sca: number of scattering angles for spherical cubature estimate of σ_sca\n\n\n\n\n\n","category":"function"},{"location":"high_level/","page":"High-level Interface","title":"High-level Interface","text":"spectrum_oa","category":"page"},{"location":"high_level/#CoupledDipole.spectrum_oa","page":"High-level Interface","title":"CoupledDipole.spectrum_oa","text":" spectrum_oa(cl::Cluster, mat::Material,\n            Cubature = \"gl\", N_inc::Int = 36, N_sca::Int=36)\n\nOrientation-averaged far-field cross-sections for multiple wavelengths\n\ncl: cluster of particles\nmat: dielectric functions\nCubature: spherical cubature method\nN_inc: number of incident angles for spherical cubature\nN_sca: number of scattering angles for spherical cubature estimate of σ_sca\n\n\n\n\n\n","category":"function"},{"location":"background/#Background-and-Motivation","page":"Background and Motivation","title":"Background and Motivation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = CoupledDipole","category":"page"},{"location":"#CoupledDipole","page":"Home","title":"CoupledDipole","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for CoupledDipole.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [CoupledDipole]","category":"page"},{"location":"#CoupledDipole.absorption!-NTuple{4, Any}","page":"Home","title":"CoupledDipole.absorption!","text":"absorption(kn::Real, P::Array{Complex}, E::Array{Complex})\n\nAbsorption cross-section for each incident angle\n\nkn: wavenumber in incident medium\nP: 3N_dip x N_inc matrix, polarisations for all incidences\nE: 3N_dip x N_inc matrix, total field for all incidences\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.alpha_bare","page":"Home","title":"CoupledDipole.alpha_bare","text":"alpha_bare(λ::T, α_∞::T, α_k::Array{T}, λ_k::Array{T}, µ_k::Array{T}) where T <: Real\n\nComplex scalar polarisability, as sum of lorentz oscillators\n\nλ: wavelength in nm\nα_k: oscillator strength(s) in S.I. units\nλ_k: oscillator wavelength(s) in nm\nµ_k: damping(s) in S.I. units\n\nDefault values mimic the main resonance of Rhodamine 700\n\nExamples\n\njulia> round(alpha_bare(632.8), digits=5)\n0.14543 + 0.01222im\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.alpha_embedded","page":"Home","title":"CoupledDipole.alpha_embedded","text":"alpha_embedded(α::Complex{T}, medium::T) where T <: Real\n\nEffective point polarisability in medium, rescaled by local field correction\n\nα: bare polarisabilty\nmedium: refractive index of embedding medium\n\nDefault values mimic the main resonance of Rhodamine 700\n\nExamples\n\njulia> round(alpha_embedded(alpha_bare(632.8)), digits=5)\n0.12976 + 0.0109im\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.alpha_kuwata-NTuple{4, Any}","page":"Home","title":"CoupledDipole.alpha_kuwata","text":"alpha_kuwata(λ, ε, ε_m, Size)\n\nPrincipal polarisability components of a spheroidal particle\n\nλ: wavelength\nε: complex dielectric function\nε_m: dielectric function of surrounding medium\nSize: SVector with 3 semi-axes of the spheroid\n\nExamples\n\njulia> alpha_kuwata(500, -10+1im, SVector(30, 30, 50), 1.33^2)\n3-element SVector{3, ComplexF64} with indices SOneTo(3):\n  77076.04648078184 + 26235.664281642235im\n  77076.04648078184 + 26235.664281642235im\n -98187.15974124733 + 205835.30299929058im\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.alpha_rescale_molecule-Tuple{Any, Any}","page":"Home","title":"CoupledDipole.alpha_rescale_molecule","text":"alpha_rescale_molecule(alpha, sizes::Vector{SVector{3}})\n\nPrincipal polarisability components of a particle, rescaled along each principal axis\n\nα: scalar polarisabilty\nsizes: array of 3-vectors to scale along each principal axis\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.alpha_spheroids-NTuple{4, Any}","page":"Home","title":"CoupledDipole.alpha_spheroids","text":"alpha_spheroids(λ, ε, ε_m, Sizes)\n\nPrincipal polarisability components of N spheroidal particles\n\nλ: wavelength\nε: complex dielectric function\nε_m: dielectric function of surrounding medium\nSizes: Vector of 3-SVectors of particle sizes\n\nExamples\n\njulia> alpha_spheroids(500, -10+1im, 1.33^3, [SVector(30, 30, 50) for i in 1:4])\n4-element Vector{SVector{3, ComplexF64}}:\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n [83399.81975161123 + 64172.28157743772im, 83399.81975161123 + 64172.28157743772im, -86034.64340475321 + 79773.72029581512im]\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.cluster_dimer","page":"Home","title":"CoupledDipole.cluster_dimer","text":"cluster_dimer(d::T, a::T, b::T, c::T, dihedral::T = 0.0, α_1::T = 0.0, α_2::T = 0.0) where T <: Real\n\nParticle cluster consisting of 2 identical particles separated along y\n\na,b,c: semi-axes along x,y,z\ndihedral: angle between both particles seen along the y-axis\nmaterial: String referencing the material\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\njulia> cluster_dimer(10, 1, 2, 3)\nCluster{Float64, Float64, Int64}(SVector{3, Float64}[[0.0, -5.0, 0.0], [0.0, 5.0, 0.0]], SVector{3, Float64}[[0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], SVector{3, Int64}[[1, 2, 3], [1, 2, 3]], \"Au\", \"particle\")\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.cluster_helix","page":"Home","title":"CoupledDipole.cluster_helix","text":"cluster_helix(N, a, b, c, R, λ, δ = π/4, δ_0 = 0, handedness=\"left\",\n    material = \"Au\", type=\"particle\")\n\nHelical cluster of N identical particles with axis along z\n\nN: number of particles\na,b,c: semi-axes along x,y,z\nR: helix radius\nλ: helix pitch\nδ: angle between subsequent particles\nδ: starting angle\nhandedness: \"left\" or \"right\"\nmaterial: String referencing the material\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\ncluster_helix(5, 20, 20, 30, 50, 300)\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.cluster_single","page":"Home","title":"CoupledDipole.cluster_single","text":"cluster_single(a::T, b::T, c::T, α::T = 0.0, β::T = 0.0, γ::T = 0.0) where T <: Real\n\nParticle cluster consisting of a single particle at the origin\n\na,b,c: semi-axis along x,y,z\nα,β,γ: Euler angles\nmaterial: String referencing the material of the particle\ntype: String, \"point\" dipole or \"particle\"\n\nExamples\n\njulia> cluster_single(1.0,2.0,3.0)\nCluster{Float64, Float64, Float64}(SVector{3, Float64}[[0.0, 0.0, 0.0]], SVector{3, Float64}[[0.0, 0.0, 0.0]], SVector{3, Float64}[[1.0, 2.0, 3.0]], \"Au\", \"particle\")\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.cubature_sphere","page":"Home","title":"CoupledDipole.cubature_sphere","text":"cubature_sphere(N::Int, method::String)\n\nN-point cubature on the sphere\n\nN: number of nodes\nmethod: cubature method (only 'gl' currently implemented)\n\nReturns a Cubature object containing 2 arrays (N'x3 nodes and N'x1 weights), N'≈N Note: using array instead of tuple for weights because we'll use them in a scalar product in orientation-averaging For nodes there is less of a reason, but it can be convenient to visualise the nodes.\n\nThe cubature is normalised by 4π such that a unit integrand approximates 1.\n\nExamples\n\njulia> cubature_sphere(6)\n(nodes = SVector{3, Float64}[[0.43625314334650644, 2.1862760354652844, 0.0], [0.43625314334650644, 0.9553166181245093, 0.0], [2.0735107047038173, 2.1862760354652844, 0.0], [2.0735107047038173, 0.9553166181245093, 0.0], [4.2096746024757685, 2.1862760354652844, 0.0], [4.2096746024757685, 0.9553166181245093, 0.0], [5.846932163833079, 2.1862760354652844, 0.0], [5.846932163833079, 0.9553166181245093, 0.0]], weights = [0.08696371128436346, 0.08696371128436346, 0.16303628871563655, 0.16303628871563655, 0.16303628871563655, 0.16303628871563655, 0.08696371128436346, 0.08696371128436346])\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.depolarisation_spheroid-Tuple{Any, Any, Any}","page":"Home","title":"CoupledDipole.depolarisation_spheroid","text":"depolarisation_spheroid(a, b, c)\n\nDepolarisation factor of a spheroid\n\na: semi-axis along x and y\nb: semi-axis along x and y (unused)\nc: semi-axis along z\n\nExamples\n\njulia> round.(depolarisation_spheroid(1, 1, 1.5), digits=5)\n3-element SVector{3, Float64} with indices SOneTo(3):\n 0.38351\n 0.38351\n 0.23298\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.epsilon_Ag-Tuple{Any}","page":"Home","title":"CoupledDipole.epsilon_Ag","text":"epsilon_Ag(λ::Real)\n\nDrude model for the dielectric function of silver in the visible region\n\nλ: wavelength in nm\n\nExamples\n\njulia> round(epsilon_Ag(632.8), digits=5)\n-16.11377 + 0.74871im\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.epsilon_Au-Tuple{Any}","page":"Home","title":"CoupledDipole.epsilon_Au","text":"epsilon_Au(λ::Real)\n\nExtended Drude model for the dielectric function of gold in the visible region\n\nλ: wavelength in nm\n\nExamples\n\njulia>  round(epsilon_Au(632.8), digits=5)\n-11.40185 + 1.18679im\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.euler_active","page":"Home","title":"CoupledDipole.euler_active","text":"euler_active(φ::Real, θ::Real, ψ::Real)\n\n3D rotation matrix\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\nψ: Euler angle (rotation around z\", in [0,2π])\n\nExamples\n\njulia> round.(euler_active(π/2,0,0), digits=5)\n3×3 SMatrix{3, 3, Float64, 9} with indices SOneTo(3)×SOneTo(3):\n  0.0  -1.0  0.0\n  1.0   0.0  0.0\n -0.0   0.0  1.0\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.euler_passive","page":"Home","title":"CoupledDipole.euler_passive","text":"euler_passive(φ::Real, θ::Real, ψ::Real)\n\n3D rotation matrix\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\nψ: Euler angle (rotation around z\", in [0,2π])\n\nExamples\n\njulia> round.(euler_passive(π/2,0,0), digits=5)\n3×3 SMatrix{3, 3, Float64, 9} with indices SOneTo(3)×SOneTo(3):\n  0.0  1.0  -0.0\n -1.0  0.0   0.0\n  0.0  0.0   1.0\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.euler_unitvector-Tuple{Any, Any}","page":"Home","title":"CoupledDipole.euler_unitvector","text":"euler_unitvector(φ::Real, θ::Real)\n\nUnit vector along direction φ, θ\n\nφ: Euler angle (longitude, in [0,2π])\nθ: Euler angle (colatitude, in [0,2π])\n\nExamples\n\njulia> euler_unitvector(π/2, 0)\n3-element SVector{3, Float64} with indices SOneTo(3):\n 0.0\n 0.0\n 1.0\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.extinction!-NTuple{4, Any}","page":"Home","title":"CoupledDipole.extinction!","text":"extinction(kn::Real, P::Array{Complex}, Ein::Array{Complex})\n\nExtinction cross-section for each incident angle\n\nkn: wavenumber in incident medium\nP:   3N_dip x N_inc matrix, polarisations for all incidences\nEin: 3N_dip x N_inc matrix, incident field for all incidences\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.incident_field!-NTuple{5, Any}","page":"Home","title":"CoupledDipole.incident_field!","text":"incident_field!(Ein,\n    Ejones,\n    kn, R::Vector{SVector{3}},\n    IncidenceRotations)\n\nIncident field at particle positions\n\nEin: 3N_dip x N_inc matrix, right-hand side of coupled-dipole system\nEjones: tuple of 2 2-Svectors defining 2 orthogonal Jones polarisations\nkn: wavenumber in incident medium\nR: N_dip-vector of 3-Svectors of particle positions\nIncidenceRotations: N_inc-vector of rotation 3-Smatrices\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.lorentzian","page":"Home","title":"CoupledDipole.lorentzian","text":"lorentzian(λ::T, α_k::T, λ_k::T, µ_k::T) where T <: Real\n\nComplex Lorentz function, to describe polarisabilities\n\nλ: wavelength in nm\nα_k: oscillator strength in S.I. units\nλ_k: oscillator wavelength in nm\nµ_k: damping in S.I. units\n\nExamples\n\njulia> round(lorentzian(632.8)*1e39, digits=5)\n6.58095 + 1.35961im\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.polarisation!-Tuple{Any, Any, Any}","page":"Home","title":"CoupledDipole.polarisation!","text":"polarisation!(P, E, AlphaBlocks)\n\nSelf-consistent dipole moments from the electric field, P = αE\n\nP: 3N_dip x N_inc matrix, polarisations for all incidences\nE: 3N_dip x N_inc matrix, total field for all incidences\nAlphaBlocks: N_dip-vector of 3x3 Smatrices (polarisability tensors in the lab frame)\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.propagator_freespace_labframe!-NTuple{4, Any}","page":"Home","title":"CoupledDipole.propagator_freespace_labframe!","text":"propagator_freespace_labframe!(A,\n    kn, R::Vector{SVector{3}},\n    AlphaBlocks::Vector{SMatrix{3,3}})\n\nInteraction matrix\n\nA: 3N_dip x 3N_dip interaction matrix\nkn: wavenumber in incident medium\nR: N_dip-vector of 3-Svectors of particle positions\nAlphaBlocks: N_dip-vector of 3x3 Smatrices (polarisability tensors in the lab frame)\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.quadrature_lgwt-Tuple{Any, Any, Any}","page":"Home","title":"CoupledDipole.quadrature_lgwt","text":"quadrature_lgwt(N::Int, a::Real, b::Real)\n\nN-point Gauss-Legendre quadrature over [a,b] interval\n\nN: number of nodes\na,b: bounds\n\nint_a^b f(x)dx=fracb-a2int_-1^1fleft(fracb-a2 x + fraca+b2right)dx\n\nExamples\n\njulia> quadrature_lgwt(6,0,3)\n(nodes = [0.10129572869527204, 0.5081859203006033, 1.1420712208752046, 1.8579287791247954, 2.4918140796993966, 2.898704271304728], weights = [0.25698673856875537, 0.5411423595722078, 0.7018709018590369, 0.7018709018590369, 0.5411423595722078, 0.25698673856875537])\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.scattering!-NTuple{6, Any}","page":"Home","title":"CoupledDipole.scattering!","text":"scattering(positions::Vector{SVector{3}}, ScatteringVectors::Vector{SVector{3}}, weights::Vector{Real}, kn::Real, P::Array{Complex})\n\nScattering cross-section for each incident angle, obtained by numerical cubature over the full solid angle of scattering directions\n\npositions: vector of cluster particle positions\nScatteringProjectorz: N_inc-vector of far-field directions\nweights: N_inc-vector of cubature weights\nkn: wavenumber in incident medium\nP: 3N_dip x N_inc matrix, polarisations for all incidences\n\n\n\n\n\n","category":"method"},{"location":"#CoupledDipole.spectrum_dispersion","page":"Home","title":"CoupledDipole.spectrum_dispersion","text":" spectrum_dispersion(cl::Cluster, mat::Material,\n                     Incidence, N_sca::Int=36)\n\nSimulating far-field cross-sections for multiple wavelengths and directions of incidence\n\ncl: cluster of particles\nmat: dielectric functions\nIncidence: N_inc vector of 3-Svectors of incidence Euler angles\nN_sca: number of scattering angles for spherical cubature estimate of σ_sca\n\n\n\n\n\n","category":"function"},{"location":"#CoupledDipole.spectrum_oa","page":"Home","title":"CoupledDipole.spectrum_oa","text":" spectrum_oa(cl::Cluster, mat::Material,\n            Cubature = \"gl\", N_inc::Int = 36, N_sca::Int=36)\n\nOrientation-averaged far-field cross-sections for multiple wavelengths\n\ncl: cluster of particles\nmat: dielectric functions\nCubature: spherical cubature method\nN_inc: number of incident angles for spherical cubature\nN_sca: number of scattering angles for spherical cubature estimate of σ_sca\n\n\n\n\n\n","category":"function"},{"location":"cross_sections/#Far-field-cross-sections","page":"Far field cross-sections","title":"Far field cross-sections","text":"","category":"section"},{"location":"cross_sections/#Extinction","page":"Far field cross-sections","title":"Extinction","text":"","category":"section"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"The extinction cross-section may be obtained from the optical theorem as the interference between incident and scattered fields,","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"sigma_textext = 4pikappa^-1 k_1 Imleft(mathbfP cdot mathbfE_textinc^* right)","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"extinction!","category":"page"},{"location":"cross_sections/#CoupledDipole.extinction!","page":"Far field cross-sections","title":"CoupledDipole.extinction!","text":"extinction(kn::Real, P::Array{Complex}, Ein::Array{Complex})\n\nExtinction cross-section for each incident angle\n\nkn: wavenumber in incident medium\nP:   3N_dip x N_inc matrix, polarisations for all incidences\nEin: 3N_dip x N_inc matrix, incident field for all incidences\n\n\n\n\n\n","category":"function"},{"location":"cross_sections/#Absorption","page":"Far field cross-sections","title":"Absorption","text":"","category":"section"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"The absorption cross-section is obtained by evaluating the work done by the total field, (but excluding self-reaction), on the dipoles:","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"sigma_textabs =  4pi kappa^-1 k_1 leftImleft(mathbfP cdot mathbfE^* right) - frac 2 3 kappa^-1 k_1^3 mathbfP^2right","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"absorption!","category":"page"},{"location":"cross_sections/#CoupledDipole.absorption!","page":"Far field cross-sections","title":"CoupledDipole.absorption!","text":"absorption(kn::Real, P::Array{Complex}, E::Array{Complex})\n\nAbsorption cross-section for each incident angle\n\nkn: wavenumber in incident medium\nP: 3N_dip x N_inc matrix, polarisations for all incidences\nE: 3N_dip x N_inc matrix, total field for all incidences\n\n\n\n\n\n","category":"function"},{"location":"cross_sections/#Scattering","page":"Far field cross-sections","title":"Scattering","text":"","category":"section"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"The scattering cross-section can be computed in two ways:","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"as the difference between extinction and absorption\nby integrating the flux of the Poynting vector over all scattering directions in the far-field. ","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"Comparing both results might be useful as a consistency check.","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"sigma_textsca = kappa^-2 k_1^4 iint_Omega leftsum_i left(mathbbI - mathbfhat notimesmathbfhat nright) mathbfP_i mathrmexp(-ik_1 mathbfr_icdotmathbfhat n)right^2 textdOmega","category":"page"},{"location":"cross_sections/","page":"Far field cross-sections","title":"Far field cross-sections","text":"scattering!","category":"page"},{"location":"cross_sections/#CoupledDipole.scattering!","page":"Far field cross-sections","title":"CoupledDipole.scattering!","text":"scattering(positions::Vector{SVector{3}}, ScatteringVectors::Vector{SVector{3}}, weights::Vector{Real}, kn::Real, P::Array{Complex})\n\nScattering cross-section for each incident angle, obtained by numerical cubature over the full solid angle of scattering directions\n\npositions: vector of cluster particle positions\nScatteringProjectorz: N_inc-vector of far-field directions\nweights: N_inc-vector of cubature weights\nkn: wavenumber in incident medium\nP: 3N_dip x N_inc matrix, polarisations for all incidences\n\n\n\n\n\n","category":"function"}]
}
